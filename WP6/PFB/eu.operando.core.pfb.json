{
    "swagger": "2.0",
    "info": {
        "title": "eu.operando.core.pfb",
        "description": "Operando PfB module.",
        "version": "1.0.0",
        "license": {
            "name": "MIT",
            "url": "http://opensource.org/licenses/MIT"
        }
    },
    "host": "localhost:8080",
    "schemes": [
        "http"
    ],
    "basePath": "/operando/core/pfb",
    "produces": [
        "application/json"
    ],
    "paths": {
        "/getOffers": {
            "get": {
                "summary": "Gets offers related to a website.",
                "description": "Extension sends request to PfB service to get a list of offers for the website when signup page is detected.",
                "operationId": "getOffers",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "in": "query",
                        "name": "websiteId",
                        "description": "ID of the website giving the offers.",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/Offer"
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/requestOffer": {
            "put": {
                "summary": "Indicates the user's acceptance for an offer.",
                "description": "Triggered by the extension to PfB service to indicate that the user has chosen to accept the offer (i.e. initiated login with Social Network button)",
                "operationId": "requestOffer",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "in": "query",
                        "name": "userId",
                        "description": "User Id.",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "query",
                        "name": "offerId",
                        "description": "Offer Id.",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/getPendingDeals": {
            "get": {
                "summary": "Gets the list of all pending deal requests for a user.",
                "description": "Extension requests from PfB service the list of all pending deal requests for a user.",
                "operationId": "getPendingDeals",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "in": "query",
                        "name": "userId",
                        "description": "ID of the user.",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation (an array containing the codes of pending deals for the user)",
                        "schema": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/getOfferStatus": {
            "get": {
                "summary": "Gets the status of a given offer.",
                "description": "Get the status of a given offer.",
                "operationId": "getOfferStatus",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "in": "query",
                        "name": "offerId",
                        "description": "Offer Id.",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation (the offer status)",
                        "schema": {
                            "$ref": "#/definitions/OfferStatus"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/osp": {
            "post": {
                "summary": "Registers a new OSP.",
                "description": "Request from Administration Console to register a new Online Service Provider.",
                "operationId": "registerOSP",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "osp",
                        "in": "body",
                        "description": "The OSP data in JSON format.",
                        "schema": {
                            "$ref": "#/definitions/OSP"
                        },
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation (security token)",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            },
            "put": {
                "summary": "Updates an existing OSP.",
                "description": "Request from Administration Console to updates an existing OSP.",
                "operationId": "updateOSP",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "osp",
                        "in": "body",
                        "description": "The OSP data in JSON format.",
                        "schema": {
                            "$ref": "#/definitions/OSP"
                        },
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation (security token)",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            },
            "get": {
                "summary": "Finds the osps matching the filter criteria.",
                "description": "Finds the osps matching the filter criteria.",
                "operationId": "getOSPs",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "osp",
                        "in": "body",
                        "description": "The OSP data in JSON format.",
                        "schema": {
                            "$ref": "#/definitions/OSP"
                        },
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/OSP"
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/osp/{ospId}": {
            "get": {
                "summary": "Finds an osp by ID.",
                "description": "Finds an osp unit by ID.",
                "operationId": "getOSP",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "ospId",
                        "in": "path",
                        "description": "ID of the osp that needs to be fetched.",
                        "type": "string",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "schema": {
                            "$ref": "#/definitions/OSP"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            },
            "delete": {
                "summary": "Deletes an existing osp.",
                "description": "Deletes an existing osp.",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "ospId",
                        "in": "path",
                        "description": "ID of the osp that needs to be deleted",
                        "type": "string",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/user/listOffers": {
            "get": {
                "summary": "List of all offers applicable for a specific user.",
                "description": "Request from privacy dashboard to get a list of all offers applicable for a specific user.",
                "operationId": "getOfferListByUser",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "in": "query",
                        "name": "userId",
                        "description": "User Id.",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation (list of offers applicable to the user).",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/Offer"
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/osp/listOffers": {
            "get": {
                "summary": "List of all offers created by specific OSP.",
                "description": "Request from administration console to get a list of all offers created by specific OSP.",
                "operationId": "getOfferListByOSP",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "in": "query",
                        "name": "ospId",
                        "description": "Osp Id.",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation (list of offers created by the OSP).",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/Offer"
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/user/listAcceptedDeals": {
            "get": {
                "summary": "Returns list of offers accepted by user.",
                "description": "Request from privacy dashboard to get list of offers accepted by user (and acknowledged by OSP).",
                "operationId": "getAcceptedDealsByUser",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "in": "query",
                        "name": "userId",
                        "description": "User Id.",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation (list of offers accepted by user).",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/Offer"
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/osp/listAcceptedDeals": {
            "get": {
                "summary": "List of all users and their active deals for the OSP.",
                "description": "Request from an OSP to get a list of all users and their active deals for specific OSP (could be also for report) .",
                "operationId": "getAcceptedDealsByOSP",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "in": "query",
                        "name": "ospId",
                        "description": "Osp Id.",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation (list of offers' ids associated with users' ids).",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/OfferUser"
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/offerAccepted": {
            "put": {
                "summary": "Accepts the applicance of an offer to a user.",
                "description": "Request from an OSP to approve that offer was accepted and awarded to user.",
                "operationId": "offerAccepted",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "in": "query",
                        "name": "ospId",
                        "description": "Osp Id.",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "query",
                        "name": "offerId",
                        "description": "Offer Id.",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "query",
                        "name": "userId",
                        "description": "User Id.",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "query",
                        "name": "token",
                        "description": "Security token.",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/offer": {
            "post": {
                "summary": "Creates a new offer for an OSP .",
                "description": "Request from Administration Console to create a new offer for an OSP.",
                "operationId": "createOffer",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "in": "body",
                        "name": "offer",
                        "description": "The offer data in JSON format.",
                        "schema": {
                            "$ref": "#/definitions/Offer"
                        },
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            },
            "put": {
                "summary": "Updates an offer for an OSP .",
                "description": "Request from Administration Console to update existing offer. (limited to specific fields - TBD).",
                "operationId": "updateOffer",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "in": "body",
                        "name": "offer",
                        "description": "The offer data in JSON format.",
                        "schema": {
                            "$ref": "#/definitions/Offer"
                        },
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/offer/{offerId}": {
            "get": {
                "summary": "Finds an offer by ID.",
                "description": "Finds an ooffer by ID.",
                "operationId": "getOffer",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "offerId",
                        "in": "path",
                        "description": "ID of the offer that needs to be fetched.",
                        "type": "string",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            },
            "delete": {
                "summary": "Deletes an existing offer.",
                "description": "Deletes an existing offer.",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "offerId",
                        "in": "path",
                        "description": "ID of the offer that needs to be deleted",
                        "type": "string",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/cancelDeal": {
            "delete": {
                "summary": "Cancel a deal.",
                "description": "Request from Privacy Dashboard to cancel a deal.",
                "operationId": "cancelDeal",
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "in": "query",
                        "name": "userId",
                        "description": "User Id.",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "query",
                        "name": "offerId",
                        "description": "Offer Id.",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "Offer": {
            "type": "object",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Id of the offer."
                },
                "osp_id": {
                    "type": "string",
                    "description": "Id of the OSP to which belongs the offer."
                },
                "title": {
                    "type": "string",
                    "description": "Description of the offer."
                },
                "description": {
                    "type": "string",
                    "description": "Description of the offer."
                },
                "serviceWebsite": {
                    "type": "string",
                    "description": "Website of the offering."
                },
                "enabledDisabled": {
                    "type": "boolean",
                    "description": "Indication whether the offer is enabled or not."
                },
                "osdCallbackURL": {
                    "type": "string",
                    "description": "Callback url."
                },
                "expirationDate": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Date when the offer expires."
                }
            }
        },
        "Error": {
            "type": "object",
            "properties": {
                "code": {
                    "type": "integer",
                    "format": "int32"
                },
                "message": {
                    "type": "string"
                },
                "fields": {
                    "type": "string"
                }
            }
        },
        "OfferStatus": {
            "type": "object",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Id of the offer."
                },
                "status": {
                    "type": "string",
                    "description": "Description of the offer."
                }
            }
        },
        "OSP": {
            "type": "object",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Id of the OSP."
                },
                "name": {
                    "type": "string",
                    "description": "Name of the OSP."
                },
                "description": {
                    "type": "string",
                    "description": "Description of the OSP."
                },
                "ospWebsite": {
                    "type": "string",
                    "description": "Website of the OSP."
                }
            }
        },
        "OfferUser": {
            "type": "object",
            "properties": {
                "offerId": {
                    "type": "string",
                    "description": "Id of the Offer."
                },
                "userId": {
                    "type": "string",
                    "description": "Id of the User."
                }
            }
        }
    }
}